<!-- Navbar -->
<div class="navbar-mobile">
  <div class="logo">SwiftAid</div>

  <div class="user-info" (click)="showSide()">
    <span class="user-email">{{ currentUser?.email || "User Name" }}</span>

    <!-- Real profile image -->
    <img
      *ngIf="currentUser?.profileImageUrl; else defaultProfile"
      [src]="currentUser?.profileImageUrl"
      class="user-img"
      alt="Profile Picture"
    />

    <!-- Default profile image -->
    <ng-template #defaultProfile>
      <img
        src="https://i.pinimg.com/736x/32/e4/61/32e46132a367eb48bb0c9e5d5b659c88.jpg"
        class="user-img"
        alt="Default"
      />
    </ng-template>
  </div>
</div>

<!-- Profile Sidebar (toggle) -->
<div
  *ngIf="showSideBar"
  class="user-details-hover"
  [ngClass]="{ 'exit-animate': isExiting }"
>
  <div class="exit" (click)="exit()">
    <i class="bx bx-left-arrow-alt"></i>
  </div>

  <div class="user-pic-name">
    <img
      *ngIf="currentUser?.profileImageUrl; else placeholder"
      [src]="currentUser?.profileImageUrl"
      alt="Profile Picture"
      class="user-icon-image"
    />
    <ng-template #placeholder>
      <div class="profile">
        <img
          *ngIf="!currentUser?.profileImageUrl"
          src="https://i.pinimg.com/736x/32/e4/61/32e46132a367eb48bb0c9e5d5b659c88.jpg"
          alt=""
        />
      </div>
    </ng-template>

    <span class="user-name">{{ currentUser?.fullName || "User Name" }}</span>
  </div>

  <ul>
    <div>
      <h3 class="email">{{ currentUser?.email || "User Email" }}</h3>
      <br />
      <li
        [routerLink]="'Settings'"
        routerLinkActive="active"
        [routerLinkActiveOptions]="{ exact: true }"
      >
        <i class="bx bx-cog"></i> Setting
      </li>
    </div>

    <li (click)="logout()">Logout</li>
  </ul>
</div>

<!-- Pending Request Modal (one at a time) -->

<div class="modal-overlay" *ngIf="showNewRequestModal && currentRequest">
  <div class="alert-card">
    <div class="header">
      <p><i class="bx bx-first-aid"></i> New Request Alert</p>
    </div>
    <!-- Map Preview -->
    <div class="map-preview">
      <div class="map-container" id="map-{{ currentRequest.id }}"></div>
    </div>

    <!-- Request Info -->
    <div class="alert-info">
      <p class="alert-id">ðŸ”´ Alert #{{ currentRequest.id }}</p>
      <div class="user-info">
        <img
          *ngIf="currentRequest.profilePicture; else placeholder"
          [src]="currentRequest.profilePicture"
          alt="Profile"
          class="user-img"
        />
        <ng-template #placeholder>
          <i class="bx bx-user-circle user-icon"></i>
        </ng-template>

        <div class="user-details">
          <h3>{{ currentRequest.name }}</h3>
          <p class="role">Resident</p>
        </div>
      </div>

      <p class="timestamp">
        ðŸ•’ {{ currentRequest.timestamp | date : "MMM d, h:mm a" }}
      </p>

      <p class="status">
        <span class="dot"></span> {{ currentRequest.status }}
      </p>
    </div>

    <!-- Actions -->
    <div class="alert-actions">
      <!-- Kung SuperAdmin -->
      <button
        *ngIf="currentUser?.role === 'superAdmin'"
        class="btn-view"
        (click)="viewRequest(currentRequest)"
      >
        <i class="bx bx-show"></i> View Details
      </button>

      <!-- Kapag admin -->
      <button
        *ngIf="currentUser?.role === 'admin'"
        class="btn-view"
        (click)="viewRequest(currentRequest)"
      >
        <i class="bx bx-show"></i> View Details
      </button>
    </div>
  </div>
</div>
